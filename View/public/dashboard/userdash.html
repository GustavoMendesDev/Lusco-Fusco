<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/dash.css">
  <link rel="icon" href="../assets/icon/sunrise.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link
    href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <title>Usuário..</title>
</head>
<!--Navbar-->

<nav>
  <div class="nav-container">
    <img class="logo" src="../assets/icon/sunrise.png" alt="LF" style="width: 50px; height: auto;">


    <a href="../dashboard/diarioLF.html">
      <img src="../assets/icon/book-removebg-preview.png">
    </a>


    <a href="../dashboard/alldash.html">
      <img src="../assets/icon/tocador-de-musica-removebg-preview.png">
    </a>



    <a class="checado" href="../dashboard/userdash.html">
      <img src="../assets/icon/usericon.png">
    </a>


    <a href="../index.html">
      <img src="../assets/icon/logout-removebg-preview.png">
    </a>
  </div>
</nav>
<!--Fim do nav-bar-->

<body onload="MusicaTop(); ArtistaTop(); UserDiario();">
  <div class="page">

    <div class="cardDiario">
      <h1><strong>
          <p></p>DIÁRIOS 
        </strong></h1>
      <p id="subtitle" class="subtitle"></p>
      <div class="diarioContainer" id="diariosContainer"></div>
    </div>

    <div class="cardLista">
        <div id="nome" class="nome"></div>
        <br>
      <div id="musicaContainer"></div>
      <div id="artistaContainer"></div>
      <div id="TopA"></div>
      <div id="TopM"></div>

    </div>

  </div>
</body>

<script>

  function ArtistaTop() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO
    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }
    fetch(`/user/ArtistaTop/${idUser}`)
      .then(res => res.json())
      .then(artistas => {
        if (!artistas || artistas.length == 0) {
          artistaContainer.innerHTML = "<p>Nenhum artista encontrado.</p>";
          return;
        }

        artistaContainer.innerHTML = `<h3>Top 5 Artistas </h3><br>`;

        for (var i = 0; i < artistas.length; i++) {
          var a = artistas[i];
          artistaContainer.innerHTML +=
            "<p>Artista: " + a.Artista +
            " | Vezes: " + a.Quantidade + "</p> <br>";

        }
      })
      .catch(err => {
        console.error("Erro ao buscar artistas:", err);
        artistaContainer.innerHTML = "<p>Erro ao carregar artistas.</p>";
      });
  }


  function MusicaTop() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO
    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }

    fetch(`/user/MusicaTop/${idUser}`)
      .then(res => res.json())
      .then(musicas => {
        if (!musicas || musicas.length == 0) {
          musicaContainer.innerHTML = "<p>Nenhuma música encontrada.</p>";
          return;
        }
        musicaContainer.innerHTML = `<h3> Top 5 Músicas </h3><br>`;

        for (var i = 0; i < musicas.length; i++) {
          var m = musicas[i];
          musicaContainer.innerHTML +=
            "<p>Música: " + m.Musica +
            " | Vezes: " + m.Quantidade + "</p> <br>";
        }
      })
      .catch(err => {
        console.error("Erro ao buscar músicas:", err);
        musicaContainer.innerHTML = "<p>Erro ao carregar músicas.</p>";
      });
  }


  function UserDiario() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO;

      nome.innerHTML = `<h1><strong>
       TOP 5 ♫ <br> ${nomeUser}
        </strong></h1>`

    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }
    fetch(`/user/UserDiario/${idUser}`)
      .then(res => res.json())
      .then(diarios => {
        if (!diarios || diarios.length == 0) {
          titulo.innerHTML = ``
          diariosContainer.innerHTML = "<p>Nenhum diário encontrado.</p>";
          return;
        }
        diariosContainer.innerHTML = "";
        subtitle.innerHTML = `Olá ${nomeUser} — Acompanhe seus Lusco-Fuscos`;

        var vezes = 0;

        for (var i = 0; i < diarios.length; i++) {
          vezes++;

          var d = diarios[i];

          diariosContainer.innerHTML += `
         <button onclick="DiarioView()" class="card">
      <p style="font-family: 'Poppins', sans-serif; font-size: 20px;">Diário #${vezes}</p>

      <p style="font-family: 'Elms Sans', sans-serif; font-optical-sizing: auto; font-weight: 200; font-style: italic; font-size: 17px;">
      <strong style="font-family: 'Poppins', sans-serif; font-size: 20px;">Data:</strong> ${d.dataD}
      </p>

      <p style="font-family: 'Elms Sans', sans-serif; font-optical-sizing: auto; font-weight: 200; font-style: italic; font-size: 17px;">
      <strong style="font-family: 'Poppins', sans-serif; font-size: 20px;">Relato:</strong> ${d.relato}
      </p>

      <p style="font-family: 'Elms Sans', sans-serif; font-optical-sizing: auto; font-weight: 200; font-style: italic; font-size: 17px;">
      <strong style="font-family: 'Poppins', sans-serif; font-size: 20px;">Música:</strong> ${d.musica}
      </p>
         </button>
         <br><br>
        `;
        }

      })
      .catch(err => {
        console.error("Erro ao buscar diários:", err);
        diariosContainer.innerHTML = "<p>Erro ao carregar os diários.</p>";
      });

  }

  function DiarioView() {

  }

</script>

</html>