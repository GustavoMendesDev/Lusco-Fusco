<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/dash.css">
  <link rel="icon" href="../assets/icon/sunrise.png" />
  <title>Usuário..</title>
</head>
<!--Navbar-->

<nav>
  <div class="nav-container">
    <img class="logo" src="../assets/icon/sunrise.png" alt="LF" style="width: 50px; height: auto;">


    <a href="../dashboard/diarioLF.html">
      <img src="../assets/icon/book-removebg-preview.png">
    </a>


    <a href="../dashboard/alldash.html">
      <img src="../assets/icon/tocador-de-musica-removebg-preview.png">
    </a>



    <a href="../dashboard/userdash.html">
      <img src="../assets/icon/usericon.png">
    </a>


    <a href="../index.html">
      <img src="../assets/icon/logout-removebg-preview.png">
    </a>
  </div>
</nav>
<!--Fim do nav-bar-->

<body onload="MusicaTop(); ArtistaTop(); UserDiario();">
  <div class="page">

    <div class="cardD">
      <div id="titulo"></div>
      <p id="subtitle" class="subtitle"></p>
      <div class="diarioContainer" id="diariosContainer"></div>

    </div>
    <div class="cardP">
      <div id="artistaContainer"></div>

    </div>

    <div class="cardF">
      <div id="musicaContainer"></div>

    </div>

  </div>
</body>

<script>

  function ArtistaTop() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO
    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }
    fetch(`/user/ArtistaTop/${idUser}`)
      .then(res => res.json())
      .then(artistas => {
        if (!artistas || artistas.length == 0) {
          artistaContainer.innerHTML = "<p>Nenhum artista encontrado.</p>";
          return;
        }

        artistaContainer.innerHTML = `<h3>Artistas favoritos <br> De ${nomeUser}</h3><br>`;

        for (var i = 0; i < artistas.length; i++) {
          var a = artistas[i];
          artistaContainer.innerHTML +=
            "<p>Artista: " + a.Artista +
            " | Vezes: " + a.Quantidade + "</p> <br>";

        }
      })
      .catch(err => {
        console.error("Erro ao buscar artistas:", err);
        artistaContainer.innerHTML = "<p>Erro ao carregar artistas.</p>";
      });
  }


  function MusicaTop() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO
    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }

    fetch(`/user/MusicaTop/${idUser}`)
      .then(res => res.json())
      .then(musicas => {
        if (!musicas || musicas.length == 0) {
          musicaContainer.innerHTML = "<p>Nenhuma música encontrada.</p>";
          return;
        }

        musicaContainer.innerHTML = `<h3> Músicas favoritas <br> De ${nomeUser}</h3><br>`;

        for (var i = 0; i < musicas.length; i++) {
          var m = musicas[i];
          musicaContainer.innerHTML +=
            "<p>Música: " + m.Musica +
            " | Vezes: " + m.Quantidade + "</p> <br>";
        }
      })
      .catch(err => {
        console.error("Erro ao buscar músicas:", err);
        musicaContainer.innerHTML = "<p>Erro ao carregar músicas.</p>";
      });
  }


  function UserDiario() {
    var nomeUser = sessionStorage.NOME_USUARIO
    var idUser = sessionStorage.ID_USUARIO;

    if (!idUser) {
      console.error("ID do usuário não definido!");
      return;
    }
    fetch(`/user/UserDiario/${idUser}`)
      .then(res => res.json())
      .then(diarios => {
        if (!diarios || diarios.length == 0) {
          titulo.innerHTML = ``
          diariosContainer.innerHTML = "<p>Nenhum diário encontrado.</p>";
          return;
        }

        diariosContainer.innerHTML = "";
        subtitle.innerHTML = `Olá ${nomeUser} — Acompanhe seus Lusco-Fuscos`;
        var vezes = 0
        for (var i = 0; i < diarios.length; i++) {
          vezes++
          var diario = diarios[i];
          diariosContainer.innerHTML +=
            `<button onclick="DiarioView()"> <p>Número Diário : ` + vezes +
            ` | Data: ` + diario.dataD + `</p></button> <br><br>`;
        }
      })
      .catch(err => {
        console.error("Erro ao buscar diários:", err);
        diariosContainer.innerHTML = "<p>Erro ao carregar os diários.</p>";
      });

  }

  function DiarioView() {

  }

</script>

</html>